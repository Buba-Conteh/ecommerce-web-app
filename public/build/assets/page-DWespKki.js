import{r as i,j as e,a as se}from"./app-CK4fKavl.js";import{H as O}from"./header-CCpQ4azn.js";import{c as ae,u as T,a as K,B as G}from"./createLucideIcon-C78b_pTq.js";import{I as R}from"./input-iu6ULAGD.js";import{L as v}from"./label-D_lsnU-x.js";import{C as _,a as S,b as P,d as L,c as k}from"./card-DV_Icjwk.js";import{S as oe,a as ie,b as ne,c as ce,d as F}from"./select-CvUxMslo.js";import{S as M}from"./separator-CW_k5k03.js";import{u as de,c as I}from"./index-CgWafNPt.js";import{c as U}from"./index-duAVE-v9.js";import{P as E}from"./index-DqDzFycg.js";import{c as $,R as le,I as pe}from"./index-DOLNFjol.js";import{u as ue}from"./index-yUCtKGed.js";import{u as me}from"./index-D2A1fZ3i.js";import{u as he}from"./index-DNCT5Y2j.js";import{P as xe}from"./index-BnFFKm-E.js";import{u as fe}from"./cart-provider-k14Zb0I6.js";import{T as je}from"./truck-BfY2GyHh.js";import{C as D,L as ye}from"./lock-CqghE570.js";import{L as ve}from"./loader-circle-CaEXalpa.js";/* empty css            */import"./badge-DE2SN-lv.js";import"./avatar-BZC-hOL3.js";import"./index-Ck9pgLKd.js";import"./heart-CWxFlDi0.js";import"./Combination-ChtfIEPt.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ne=ae("Circle",ge);var q="Radio",[be,V]=U(q),[Ce,we]=be(q),z=i.forwardRef((s,n)=>{const{__scopeRadio:a,name:u,checked:t=!1,required:c,disabled:p,value:x="on",onCheck:f,form:j,...d}=s,[o,y]=i.useState(null),m=T(n,r=>y(r)),h=i.useRef(!1),b=o?j||!!o.closest("form"):!0;return e.jsxs(Ce,{scope:a,checked:t,disabled:p,children:[e.jsx(E.button,{type:"button",role:"radio","aria-checked":t,"data-state":Y(t),"data-disabled":p?"":void 0,disabled:p,value:x,...d,ref:m,onClick:I(s.onClick,r=>{t||f?.(),b&&(h.current=r.isPropagationStopped(),h.current||r.stopPropagation())})}),b&&e.jsx(X,{control:o,bubbles:!h.current,name:u,value:x,checked:t,required:c,disabled:p,form:j,style:{transform:"translateX(-100%)"}})]})});z.displayName=q;var H="RadioIndicator",J=i.forwardRef((s,n)=>{const{__scopeRadio:a,forceMount:u,...t}=s,c=we(H,a);return e.jsx(xe,{present:u||c.checked,children:e.jsx(E.span,{"data-state":Y(c.checked),"data-disabled":c.disabled?"":void 0,...t,ref:n})})});J.displayName=H;var Re="RadioBubbleInput",X=i.forwardRef(({__scopeRadio:s,control:n,checked:a,bubbles:u=!0,...t},c)=>{const p=i.useRef(null),x=T(p,c),f=he(a),j=me(n);return i.useEffect(()=>{const d=p.current;if(!d)return;const o=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(o,"checked").set;if(f!==a&&m){const h=new Event("click",{bubbles:u});m.call(d,a),d.dispatchEvent(h)}},[f,a,u]),e.jsx(E.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...t,tabIndex:-1,ref:x,style:{...t.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X.displayName=Re;function Y(s){return s?"checked":"unchecked"}var _e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],A="RadioGroup",[Se,cr]=U(A,[$,V]),W=$(),Q=V(),[Pe,ke]=Se(A),Z=i.forwardRef((s,n)=>{const{__scopeRadioGroup:a,name:u,defaultValue:t,value:c,required:p=!1,disabled:x=!1,orientation:f,dir:j,loop:d=!0,onValueChange:o,...y}=s,m=W(a),h=ue(j),[b,r]=de({prop:c,defaultProp:t??null,onChange:o,caller:A});return e.jsx(Pe,{scope:a,name:u,required:p,disabled:x,value:b,onValueChange:r,children:e.jsx(le,{asChild:!0,...m,orientation:f,dir:h,loop:d,children:e.jsx(E.div,{role:"radiogroup","aria-required":p,"aria-orientation":f,"data-disabled":x?"":void 0,dir:h,...y,ref:n})})})});Z.displayName=A;var ee="RadioGroupItem",re=i.forwardRef((s,n)=>{const{__scopeRadioGroup:a,disabled:u,...t}=s,c=ke(ee,a),p=c.disabled||u,x=W(a),f=Q(a),j=i.useRef(null),d=T(n,j),o=c.value===t.value,y=i.useRef(!1);return i.useEffect(()=>{const m=b=>{_e.includes(b.key)&&(y.current=!0)},h=()=>y.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",h),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",h)}},[]),e.jsx(pe,{asChild:!0,...x,focusable:!p,active:o,children:e.jsx(z,{disabled:p,required:c.required,checked:o,...f,...t,name:c.name,ref:d,onCheck:()=>c.onValueChange(t.value),onKeyDown:I(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:I(t.onFocus,()=>{y.current&&j.current?.click()})})})});re.displayName=ee;var Fe="RadioGroupIndicator",te=i.forwardRef((s,n)=>{const{__scopeRadioGroup:a,...u}=s,t=Q(a);return e.jsx(J,{...t,...u,ref:n})});te.displayName=Fe;var Ee=Z,Ae=re,Ie=te;function Te({className:s,...n}){return e.jsx(Ee,{"data-slot":"radio-group",className:K("grid gap-3",s),...n})}function B({className:s,...n}){return e.jsx(Ae,{"data-slot":"radio-group-item",className:K("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...n,children:e.jsx(Ie,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(Ne,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function dr(){const{state:s,clearCart:n}=fe(),[a,u]=i.useState("stripe"),[t,c]=i.useState({first_name:"",last_name:"",email:"",address_line_1:"",city:"",state:"",postal_code:"",country:""}),[p,x]=i.useState(!1),[f,j]=i.useState(null),d=i.useMemo(()=>{const r=s.items.reduce((C,w)=>C+w.price*w.quantity,0),g=Math.round(r*.1*100)/100,l=r>100?0:9.99,N=Math.round((r+g+l)*100)/100;return{subtotal:r,tax:g,shipping:l,total:N}},[s.items]),o=(r,g)=>{c(l=>({...l,[r]:g}))},y=async()=>{x(!0),j(null);try{const r=await fetch("/api/guest-checkout",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},credentials:"same-origin",body:JSON.stringify({customer:t,items:s.items.map(N=>({id:N.id,quantity:N.quantity,price:N.price}))})});if(!r.ok)throw new Error("Failed to create order");const l=(await r.json()).order;a==="stripe"?await m(l.id,d.total):await h(l.id,d.total)}catch(r){console.error(r),j(r.message||"Failed to place order. Please try again."),x(!1)}},m=async(r,g)=>{try{const l=await fetch("/api/payments/stripe/create-intent",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},credentials:"same-origin",body:JSON.stringify({order_id:r,amount:g})});if(!l.ok)throw new Error("Failed to initialize payment");const N=await l.json(),C=await b();if(!C)throw new Error("Failed to load Stripe");const{error:w}=await C.confirmCardPayment(N.client_secret,{payment_method:{card:{token:"card"},billing_details:{name:`${t.first_name} ${t.last_name}`,email:t.email,address:{line1:t.address_line_1,city:t.city,state:t.state,postal_code:t.postal_code,country:t.country}}}});if(w)throw new Error(w.message);if(!(await fetch("/api/payments/stripe/confirm",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},credentials:"same-origin",body:JSON.stringify({payment_intent_id:N.client_secret.split("_secret_")[0],order_id:r})})).ok)throw new Error("Failed to confirm payment");n(),se.visit("/orders?success=payment_completed")}catch(l){throw l}},h=async(r,g)=>{try{const l=await fetch("/api/payments/paypal/create-order",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},credentials:"same-origin",body:JSON.stringify({order_id:r,amount:g})});if(!l.ok)throw new Error("Failed to initialize PayPal payment");const C=(await l.json()).links?.find(w=>w.rel==="approve");if(C)window.location.href=C.href;else throw new Error("Failed to get PayPal approval URL")}catch(l){throw l}},b=async()=>null;return!s.items||s.items.length===0?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(O,{}),e.jsx("div",{className:"container mx-auto px-4 py-16",children:e.jsxs(_,{className:"max-w-md mx-auto text-center",children:[e.jsxs(S,{children:[e.jsx(P,{className:"text-2xl",children:"Your Cart is Empty"}),e.jsx(L,{children:"Add some items to your cart before checkout."})]}),e.jsx(k,{children:e.jsx(G,{asChild:!0,className:"w-full",children:e.jsx("a",{href:"/",children:"Continue Shopping"})})})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(O,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Checkout"}),f&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600",children:f})}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(_,{children:[e.jsx(S,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"Shipping Information"]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"first_name",children:"First Name"}),e.jsx(R,{id:"first_name",placeholder:"John",value:t.first_name,onChange:r=>o("first_name",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"last_name",children:"Last Name"}),e.jsx(R,{id:"last_name",placeholder:"Doe",value:t.last_name,onChange:r=>o("last_name",r.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"email",children:"Email"}),e.jsx(R,{id:"email",type:"email",placeholder:"john@example.com",value:t.email,onChange:r=>o("email",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"address_line_1",children:"Address"}),e.jsx(R,{id:"address_line_1",placeholder:"123 Main St",value:t.address_line_1,onChange:r=>o("address_line_1",r.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"city",children:"City"}),e.jsx(R,{id:"city",placeholder:"New York",value:t.city,onChange:r=>o("city",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"state",children:"State"}),e.jsx(R,{id:"state",placeholder:"NY",value:t.state,onChange:r=>o("state",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"postal_code",children:"Postal Code"}),e.jsx(R,{id:"postal_code",placeholder:"10001",value:t.postal_code,onChange:r=>o("postal_code",r.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"country",children:"Country"}),e.jsxs(oe,{value:t.country,onValueChange:r=>o("country",r),children:[e.jsx(ie,{id:"country",children:e.jsx(ne,{placeholder:"Select country"})}),e.jsxs(ce,{children:[e.jsx(F,{value:"US",children:"United States"}),e.jsx(F,{value:"CA",children:"Canada"}),e.jsx(F,{value:"GB",children:"United Kingdom"}),e.jsx(F,{value:"AU",children:"Australia"})]})]})]})]})]}),e.jsxs(_,{children:[e.jsxs(S,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Payment Method"]}),e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Your payment information is secure and encrypted"]})]}),e.jsx(k,{children:e.jsxs(Te,{value:a,onValueChange:r=>u(r),children:[e.jsxs("div",{className:"flex items-center space-x-2 p-4 border rounded-lg cursor-pointer hover:bg-accent",children:[e.jsx(B,{value:"stripe",id:"stripe"}),e.jsx(v,{htmlFor:"stripe",className:"flex-1 cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Credit Card"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Visa, Mastercard, Amex"})]}),e.jsx(D,{className:"w-8 h-8"})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-4 border rounded-lg cursor-pointer hover:bg-accent",children:[e.jsx(B,{value:"paypal",id:"paypal"}),e.jsx(v,{htmlFor:"paypal",className:"flex-1 cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"PayPal"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pay with your PayPal account"})]}),e.jsx(Paypal,{className:"w-8 h-8 text-[#0070BA]"})]})})]})]})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{className:"sticky top-8",children:[e.jsx(S,{children:e.jsx(P,{children:"Order Summary"})}),e.jsxs(k,{className:"space-y-4",children:[s.items.map(r=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[r.name," Ã— ",r.quantity]}),e.jsxs("span",{children:["$",(r.price*r.quantity).toFixed(2)]})]},r.id)),e.jsx(M,{}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",d.subtotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Tax"}),e.jsxs("span",{children:["$",d.tax.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:d.shipping===0?"Free":`$${d.shipping.toFixed(2)}`})]}),e.jsx(M,{}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",d.total.toFixed(2)]})]})]}),e.jsx("div",{className:"p-6 pt-0",children:e.jsx(G,{className:"w-full",size:"lg",disabled:p||s.items.length===0,onClick:y,children:p?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsx(e.Fragment,{children:"Complete Order"})})})]})})]})]})]})}export{dr as default};
